{"ast":null,"code":"import jwt from 'jsonwebtoken';\nconst secret = 'nextweb';\nexport default function signIn(req, res) {\n  const {\n    email,\n    password\n  } = req.body;\n  let response = null;\n  let status = 200;\n\n  if (email !== 'admin@domain.com' || password !== 'password') {\n    status = 401;\n    response = {\n      message: 'Email or password is not correct.'\n    };\n  } else {\n    const payload = {\n      sub: email,\n      name: email,\n      role: 'admin',\n      exp: Math.floor(Date.now() / 1000) + 60 * 60 // 1 hour\n\n    };\n    const token = jwt.sign(payload, secret);\n    response = {\n      token\n    };\n  }\n\n  res.status(status).json(response);\n}","map":null,"metadata":{},"sourceType":"module"}